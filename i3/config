# GENERAL CONFIG {{{
set $mpdhost localhost
set $mod Mod4
set $alt Mod1
set $narrowbarfont font pango:Times New Roman 9
floating_modifier $mod
set $narrow1 DP-3
set $narrow2 DP-1
set $narrow3 DP-2
set $wide HDMI-1
set $barmodifier modifier Mod3

gaps inner 5
smart_borders on

# fake-outputs 1200x1920+0+689,1200x1920+1200+689,2560x1440+2400+1467,2560x1440+2400+0,1200x1920+4960+689,1200x1920+6160+689
# WINDOW STYLE: <normal | none | pixel X>
new_window pixel 1
new_float pixel 1
  # <none | vertical | horizontal | both>
hide_edge_borders none
font pango:DejaVu Sans Mono 10

# MISC SETTINGS
focus_follows_mouse no
force_focus_wrapping no
workspace_auto_back_and_forth no
force_display_urgency_hint 1000 ms
# <horizontal | vertical | auto>
default_orientation auto
  # <default | stacking | tabbed>
workspace_layout default
  # <smart | ignore | leave_fullscreen>
popup_during_fullscreen smart
# }}}
# COLORS {{{
# window class             tbar bor      tbar bg        tbar text       indicator
client.focused             #224488       #224488         #FFFFFF         #2e9ef4
client.focused_inactive    #114411       #114411         #FFFFFF         #484e50
client.unfocused           #606060       #404040         #DDDDDD         #292d2e
client.urgent              #2f343a       #900000         #FFFFFF         #900000
client.background          #000000

#                              class         border     bg      text
set $focused_workspace   focused_workspace  #224488  #224488  #FFFFFF
set $active_workspace    active_workspace   #114411  #114411  #FFFFFF
set $inactive_workspace  inactive_workspace #404040  #404040  #AAAAAA
set $urgent_workspace    urgent_workspace   #A04040  #A04040  #FFFFFF
set $background          background         #000000
set $statusline          statusline         #CCCCCC
# }}}
# STARTUP APPLICATIONS {{{
# exec_always will run when i3 is restarted, not just initially
exec --no-startup-id dunst
exec --no-startup-id unclutter
# also add clipmenu in here instead of clipit history search?
# would need to modify it to sort by date, use sexier dmenu
# there's branches and pull requests possibly worth looking at which address this
# https://github.com/cdown/clipmenu
exec --no-startup-id clipit
exec --no-startup-id xset m 0 0
# exec --no-startup-id nitrogen --restore
exec --no-startup-id xsetroot -solid "#331133"
exec --no-startup-id dropbox-cli start
# exec --no-startup-id udiskie &
exec --no-startup-id amixer set PCM 208
exec --no-startup-id amixer set Master 25
exec --no-startup-id pasystray
exec --no-startup-id nm-applet
# exec --no-startup-id ~/dotfiles/scripts/mailbox_notify_daemon.sh # TODO fix this
exec --no-startup-id ~/dotfiles/scripts/startup.sh
# }}}
# KEYBINDS {{{
  ### conky and config controls
bindsym $mod+Shift+B    exec killall conky && killall i3bar
bindsym $mod+Shift+R    exec killall conky; restart
bindsym $mod+Shift+E    exec "i3-nagbar -t warning -m 'End xsession?' -b 'Yes, exit i3' 'i3-msg exit'"
bindsym $mod+Shift+Q    kill
bindsym $mod+Shift+C    reload

  ### borders
bindsym $mod+t          border normal 1
bindsym $mod+y          border pixel 1
bindsym $mod+n          border none

 ### scratchpad
bindsym $mod+Shift+minus    move scratchpad
bindsym $mod+minus          scratchpad show

  ### switch audio device
# TODO update these for pulse
# bindsym $mod+$alt+Control+m exec device.sh mobo
# bindsym $mod+$alt+Control+x exec device.sh xfi
# bindsym $mod+$alt+Control+h exec device.sh headset
# bindsym $mod+$alt+Control+t exec device.sh hdmi; exec hdmi.sh on

bindsym Pause               exec mpc -h $mpdhost pause; exec echo cycle pause > ~/.mpv/mpvfifo
bindsym XF86AudioPause      exec mpc -h $mpdhost pause; exec echo cycle pause > ~/.mpv/mpvfifo
bindsym XF86AudioNext       exec echo playlist_next > ~/.mpv/mpvfifo
bindsym XF86AudioPrev       exec echo playlist_prev > ~/.mpv/mpvfifo

  ### volume controls
bindsym $mod+$alt+minus         exec ~/dotfiles/scripts/audio/volume.sh 1% -
bindsym $mod+$alt+plus          exec ~/dotfiles/scripts/audio/volume.sh 1% +
bindsym XF86AudioLowerVolume    exec ~/dotfiles/scripts/audio/volume.sh 1% -
bindsym XF86AudioRaiseVolume    exec ~/dotfiles/scripts/audio/volume.sh 1% +
bindsym $mod+Control+minus      exec ~/dotfiles/scripts/audio/volume.sh 5% -
bindsym $mod+Control+plus       exec ~/dotfiles/scripts/audio/volume.sh 5% +
bindsym $mod+$alt+Control+minus exec ~/dotfiles/scripts/audio/volume.sh 10% -
bindsym $mod+$alt+Control+plus  exec ~/dotfiles/scripts/audio/volume.sh 10% +
bindsym $mod+$alt+Shift+minus   exec amixer -M set Master 1%-
bindsym $mod+$alt+Shift+plus    exec amixer -M set Master 1%+
bindsym $mod+$alt+m             exec ~/dotfiles/scripts/audio/volume.sh toggle
bindsym XF86AudioMute           exec ~/dotfiles/scripts/audio/volume.sh toggle

  ### mpc controls
bindsym $mod+$alt+n     exec mpc -h $mpdhost next
bindsym $mod+$alt+p     exec mpc -h $mpdhost cdprev
bindsym $mod+$alt+s     exec mpc -h $mpdhost stop
bindsym $mod+$alt+space exec mpc -h $mpdhost toggle
bindsym $mod+$alt+Left  exec mpc -h $mpdhost seek -10
bindsym $mod+$alt+Right exec mpc -h $mpdhost seek +10
bindsym $mod+$alt+Down  exec mpc -h $mpdhost seek -60
bindsym $mod+$alt+Up    exec mpc -h $mpdhost seek +60
bindsym $mod+$alt+Next  exec mpc -h $mpdhost seek -60
bindsym $mod+$alt+Prior exec mpc -h $mpdhost seek +60
bindsym $mod+$alt+t     exec killall mpd && mpd

  ### mpv controls
bindsym $mod+Control+n      exec echo playlist_next > ~/.mpv/mpvfifo
bindsym $mod+Control+p      exec echo playlist_prev > ~/.mpv/mpvfifo
bindsym $mod+Control+s      exec echo stop > ~/.mpv/mpvfifo
bindsym $mod+Control+space  exec echo cycle pause > ~/.mpv/mpvfifo
bindsym $mod+Control+Left   exec echo seek -10 relative > ~/.mpv/mpvfifo
bindsym $mod+Control+Right  exec echo seek 10 relative > ~/.mpv/mpvfifo
bindsym $mod+Control+Down   exec echo seek -60 relative > ~/.mpv/mpvfifo
bindsym $mod+Control+Up     exec echo seek 60 relative > ~/.mpv/mpvfifo
bindsym $mod+Control+Next   exec echo seek -600 relative > ~/.mpv/mpvfifo
bindsym $mod+Control+Prior  exec echo seek 600 relative > ~/.mpv/mpvfifo
bindsym $mod+Control+q      exec killall mpv

  ### program/script hotkeys
# TODO this thing is shit
# bindsym $mod+Shift+t            exec ~/dotfiles/scripts/torrentadd.sh
# bindsym $mod+Shift+y            exec ~/dotfiles/scripts/ytdl.sh
# TODO change this to use qutebrowser
# bindsym $mod+Shift+F            exec ~/dotfiles/scripts/firefox_history.sh
# bindsym $mod+c                  exec ~/dotfiles/scripts/vimtmp.sh
# bindsym $mod+Control+c          exec ~/dotfiles/scripts/vimtmp.sh last
bindsym $mod+o                  exec ~/dotfiles/scripts/startup.sh
bindsym $mod+p                  exec rofi -show run
bindsym $mod+q                  exec rofi -show window
bindsym XF86TouchpadToggle      exec ~/dotfiles/scripts/touchpadtoggle.sh
bindsym $mod+BackSpace          exec ~/dotfiles/i3/i3-bar-toggle.py
bindsym --release Shift+Print   exec gnome-screenshot -a
bindsym --release Control+Print exec gnome-screenshot -w -B
bindsym --release Print         exec grab
bindsym $mod+Print              exec pasta
bindsym $mod+Shift+Return       exec st
bindsym $mod+Return             exec STARTUPDIR="`~/.i3/xcwd/xcwd`" st
bindsym $mod+Escape             exec i3lock -c '#181818'
bindsym $mod+F4                 exec puddletag
bindsym $mod+F5                 exec mkvtoolnix-gui

bindsym $mod+Shift+D            exec ~/dotfiles/scripts/dmenu_edit_dotfiles.sh
bindsym $mod+Control+y          exec notify-send "preparing to play youtube video..." && mpv $(xclip -o)
# }}}
# PROGRAM SPECIFIC SETTINGS {{{
# for_window <criteria> command; command
# use xprop to get instance/class, WM_CLASS(STRING) line

for_window [instance="vimtmp"] move scratchpad; scratchpad show

for_window [instance="Navigator" class="Firefox"] border none
assign     [instance="Navigator" class="Firefox"] → 2: web

for_window [instance="chromium" class="Chromium"] border none

for_window [instance="vps|st-256color" class="vps|URxvt"] border 1pixel
assign     [instance="vps|st-256color" class="vps|URxvt"] → 3: vps

for_window [instance="ncmpcpp|st-256color" class="ncmpcpp|URxvt"] border 1pixel
assign     [instance="ncmpcpp|st-256color" class="ncmpcpp|URxvt"] → 4: music

for_window [instance="mutt|st-256color" class="mutt|URxvt"] border 1pixel
assign     [instance="mutt|st-256color" class="mutt|URxvt"] → 5: mail
for_window [instance="ranger|st-256color" class="ranger|URxvt"] border 1pixel
assign     [instance="ranger|st-256color" class="ranger|URxvt"] → 6: files

for_window [instance="Steam" class="Steam"] border none
assign     [instance="Steam" class="Steam"] → 11: steam
for_window [instance="hl2_linux" class="hl2_linux"] border none
for_window [instance="hl2_linux" class="hl2_linux"] fullscreen
assign     [instance="hl2_linux" class="hl2_linux"] → 12: tf2

for_window [instance="vdpau" class="mplayer2"] border none
for_window [instance="vdpau" class="mpv"] border 1pixel

for_window [instance="rangermpvaudio"] move scratchpad
for_window [instance="rangermpvaudio"] border normal 1pixel
# }}}
# WINDOW MANAGEMENT KEYBINDS {{{
  ### ijkl for moving focus
bindsym $mod+h      focus left
bindsym $mod+j      focus down
bindsym $mod+k      focus up
bindsym $mod+l      focus right
bindsym $mod+Left   focus left
bindsym $mod+Down   focus down
bindsym $mod+Up     focus up
bindsym $mod+Right  focus right
bindsym $mod+a      focus parent
bindsym $mod+d      focus child
bindsym $mod+mod1+h focus output left
bindsym $mod+mod1+j focus output down
bindsym $mod+mod1+k focus output up
bindsym $mod+mod1+l focus output right

  ### move focused window, px only applies to floating windows, default is 10
bindsym $mod+Shift+H     move left  50 px
bindsym $mod+Shift+J     move down  50 px
bindsym $mod+Shift+K     move up    50 px
bindsym $mod+Shift+L     move right 50 px
bindsym $mod+Shift+Left  move left  10px
bindsym $mod+Shift+Down  move down  10px
bindsym $mod+Shift+Up    move up    10px
bindsym $mod+Shift+Right move right 10px
# move absolute position center

  ### container layout
bindsym $mod+v split h
bindsym $mod+s split v
bindsym $mod+f fullscreen
bindsym $mod+w layout tabbed
bindsym $mod+e layout default
bindsym $mod+semicolon layout stacking

  ### floating windows
bindsym $mod+Shift+space floating toggle
bindsym $mod+space focus mode_toggle

  ### marks
bindsym $mod+m          exec i3-input -l 1 -F 'mark "%s"' -P 'create mark: '
bindsym $mod+u          exec i3-input -l 1 -F 'unmark "%s"' -P 'delete mark: '
bindsym $mod+apostrophe exec i3-input -l 1 -F '[con_mark="%s"] focus' -P 'goto mark: '
# }}}
# WORKSPACE MANAGEMENT KEYBINDS {{{
  ### automatically put workspace on certain screen on creation
    # named workspace must be quoted, eg: workspace "tf2" output DVI-D-0
workspace "1: main"   output $narrow3
workspace "2: web"    output $wide
workspace "3: vps"    output $narrow3
workspace "4: music"  output $narrow1
workspace "5: mail"   output $narrow1
workspace "6: files"  output $narrow2
workspace "7: code"   output $narrow1
workspace "8: code"   output $narrow2
workspace "9: code"   output $wide
workspace "10: code"  output $narrow3
workspace "11: steam" output $wide
workspace "12: tf2"   output $wide
workspace "13: tv"    output $wide

bindsym $mod+Tab workspace next_on_output
bindsym $mod+Shift+Tab workspace prev_on_output
bindsym $alt+Tab workspace back_and_forth

  ### move workspaces between outputs, also takes specific output name instead of direction (DVI-D-0)
bindsym $mod+Control+h move workspace to output left
bindsym $mod+Control+j move workspace to output down
bindsym $mod+Control+k move workspace to output up
bindsym $mod+Control+l move workspace to output right

  ### switch to workspace
bindsym $mod+1    workspace number 1: main
bindsym $mod+2    workspace number 2: web
bindsym $mod+3    workspace number 3: vps
bindsym $mod+4    workspace number 4: music
bindsym $mod+5    workspace number 5: mail
bindsym $mod+6    workspace number 6: files
bindsym $mod+7    workspace number 7: code
bindsym $mod+8    workspace number 8: code
bindsym $mod+9    workspace number 9: code
bindsym $mod+0    workspace number 10: code
bindsym $mod+KP_1 workspace number 11
bindsym $mod+KP_2 workspace number 12
bindsym $mod+KP_3 workspace number 13: tv
bindsym $mod+KP_4 workspace number 14
bindsym $mod+KP_5 workspace number 15
bindsym $mod+KP_6 workspace number 16
bindsym $mod+KP_7 workspace number 17
  ### move focused container to workspace
bindsym $mod+Shift+1    move workspace number 1: main
bindsym $mod+Shift+2    move workspace number 2: web
bindsym $mod+Shift+3    move workspace number 3: vps
bindsym $mod+Shift+4    move workspace number 4: music
bindsym $mod+Shift+5    move workspace number 5: mail
bindsym $mod+Shift+6    move workspace number 6: files
bindsym $mod+Shift+7    move workspace number 7: code
bindsym $mod+Shift+8    move workspace number 8: code
bindsym $mod+Shift+9    move workspace number 9: code
bindsym $mod+Shift+0    move workspace number 10: code
bindsym $mod+Shift+KP_1 move workspace number 11
bindsym $mod+Shift+KP_2 move workspace number 12
bindsym $mod+Shift+KP_3 move workspace number 13: tv
bindsym $mod+Shift+KP_4 move workspace number 14
bindsym $mod+Shift+KP_5 move workspace number 15
bindsym $mod+Shift+KP_6 move workspace number 16
bindsym $mod+Shift+KP_7 move workspace number 17

bindsym $mod+x          exec i3-input -F 'rename workspace to "%s"' -P 'New name: '
# }}}
# RESIZE MODE {{{
  # px is pixels for floating containers, ppt is percent for tiling containers
mode "resize" {
# large resizes with ijkl
  bindsym h           resize grow     left  20 px or 3 ppt
  bindsym Shift+H     resize shrink   left  20 px or 3 ppt
  bindsym J           resize grow     down  20 px or 3 ppt
  bindsym Shift+J     resize shrink   down  20 px or 3 ppt
  bindsym k           resize grow     up    20 px or 3 ppt
  bindsym Shift+K     resize shrink   up    20 px or 3 ppt
  bindsym l           resize grow     right 20 px or 3 ppt
  bindsym Shift+l     resize shrink   right 20 px or 3 ppt
# refined control with arrow keys
  bindsym Left        resize grow     left  1 px or 1 ppt
  bindsym Shift+Left  resize shrink   left  1 px or 1 ppt
  bindsym Down        resize grow     down  1 px or 1 ppt
  bindsym Shift+Down  resize shrink   down  1 px or 1 ppt
  bindsym Up          resize grow     up    1 px or 1 ppt
  bindsym Shift+Up    resize shrink   up    1 px or 1 ppt
  bindsym Right       resize grow     right 1 px or 1 ppt
  bindsym Shift+Right resize shrink   right 1 px or 1 ppt

  bindsym Return              mode "default"
  bindsym Escape              mode "default"
  bindsym Control+C           mode "default"
  bindsym Control+bracketleft mode "default"
}
bindsym $mod+r mode "resize"

bindsym $mod+bracketleft mode " "
mode " " {
  bindsym Return           mode "default"
  bindsym Escape           mode "default"
  bindsym Control+C        mode "default"
  bindsym $mod+bracketleft mode "default"
}
# }}}
# BAR WIDE {{{
bar {
  output $wide
  mode dock
  $barmodifier
  position top
  workspace_buttons yes
  font pango:Times New Roman 16
  status_command ~/.i3/conky/wide
  tray_output $wide
  colors {
    $background
    $statusline
    $focused_workspace
    $active_workspace
    $inactive_workspace
    $urgent_workspace
  }
}
# }}}
# BAR NARROW 1 {{{
bar {
  output $narrow1
  mode dock
  $barmodifier
  position top
  workspace_buttons yes
  $narrowbarfont
  status_command ~/.i3/conky/narrow1
  tray_output none
  colors {
    $background
    $statusline
    $focused_workspace
    $active_workspace
    $inactive_workspace
    $urgent_workspace
  }
}
# }}}
# BAR NARROW 2 {{{
bar {
  output $narrow2
  mode dock
  $barmodifier
  position top
  workspace_buttons yes
  $narrowbarfont
  status_command ~/.i3/conky/narrow2
  tray_output none
  colors {
    $background
    $statusline
    $focused_workspace
    $active_workspace
    $inactive_workspace
    $urgent_workspace
  }
}
# }}}
# BAR NARROW 3 {{{
bar {
  output $narrow3
  mode dock
  $barmodifier
  position top
  workspace_buttons yes
  $narrowbarfont
  status_command ~/.i3/conky/narrow3
  tray_output none
  colors {
    $background
    $statusline
    $focused_workspace
    $active_workspace
    $inactive_workspace
    $urgent_workspace
  }
}
# }}}
# vim:filetype=i3 foldmethod=marker foldlevel=0
